<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Nemo System ‚Äî Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Adicionando Font Awesome para √≠cones -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* ======= VARI√ÅVEIS CSS ======= */
:root {
  --primary: #b00000;
  --primary-light: #ff3333;
  --dark: #0a0a0a;
  --dark-secondary: #121212;
  --gray: #777;
  --gray-light: #aaa;
  --success: #00cc88;
  --warning: #ffaa00;
  --card-bg: rgba(30, 30, 30, 0.7);
  --modal-bg: rgba(10, 10, 10, 0.95);
  --shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
  --shadow-glow: 0 0 15px rgba(176, 0, 0, 0.3);
  --gradient-primary: linear-gradient(135deg, #b00000 0%, #ff3333 100%);
  --gradient-dark: linear-gradient(135deg, #050505 0%, #1a1a1a 100%);
}

/* ======= RESET & BASE ======= */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
  background: var(--dark-secondary);
  color: #fff;
  min-height: 100vh;
  overflow-x: hidden;
  background-image: 
    radial-gradient(circle at 10% 20%, rgba(176, 0, 0, 0.05) 0%, transparent 20%),
    radial-gradient(circle at 90% 80%, rgba(176, 0, 0, 0.05) 0%, transparent 20%);
}

/* ======= BADGE DE DISPOSITIVO ======= */
.device-badge {
  position: fixed;
  top: 10px;
  right: 10px;
  background: var(--primary);
  color: white;
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 0.7rem;
  font-weight: 600;
  z-index: 1001;
  box-shadow: var(--shadow);
  display: flex;
  align-items: center;
  gap: 5px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.device-badge::before {
  content: '';
  display: inline-block;
  width: 8px;
  height: 8px;
  background: #00ff00;
  border-radius: 50%;
  animation: pulse 2s infinite;
}

/* ======= HEADER ======= */
header {
  height: 70px;
  background: var(--dark);
  border-bottom: 1px solid rgba(176, 0, 0, 0.3);
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 25px;
  box-shadow: var(--shadow);
  position: sticky;
  top: 0;
  z-index: 1000;
}

header h1 {
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-weight: 700;
  letter-spacing: 1.5px;
  font-size: 1.8rem;
  text-shadow: 0 0 10px rgba(176, 0, 0, 0.2);
}

.logo-container {
  display: flex;
  align-items: center;
  gap: 15px;
}

.device-info {
  font-size: 0.7rem;
  color: var(--gray-light);
  background: rgba(255, 255, 255, 0.05);
  padding: 4px 8px;
  border-radius: 8px;
  display: none;
}

header img {
  width: 45px;
  filter: invert(15%) sepia(100%) saturate(5000%) hue-rotate(0deg);
  transition: transform 0.3s ease;
}

header img:hover {
  transform: scale(1.1);
}

/* ======= MENU HAMBURGUER (MOBILE) ======= */
.menu-toggle {
  display: none;
  background: transparent;
  border: none;
  color: white;
  font-size: 1.5rem;
  cursor: pointer;
  padding: 10px;
}

/* ======= LAYOUT PRINCIPAL ======= */
.wrapper {
  display: flex;
  min-height: calc(100vh - 70px);
  padding: 15px;
  gap: 15px;
}

/* ======= SIDEBAR ======= */
.sidebar {
  width: 240px;
  background: var(--dark);
  border-radius: 15px;
  padding: 20px 15px;
  box-shadow: var(--shadow);
  border: 1px solid rgba(176, 0, 0, 0.2);
  display: flex;
  flex-direction: column;
  gap: 12px;
  transition: transform 0.3s ease;
}

.sidebar.active {
  transform: translateX(0);
}

.sidebar button {
  background: transparent;
  border: 1px solid var(--primary);
  color: #fff;
  padding: 14px;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 500;
  letter-spacing: 0.5px;
  transition: all 0.3s ease;
  text-align: left;
  display: flex;
  align-items: center;
  gap: 10px;
}

.sidebar button:before {
  content: '';
  display: inline-block;
  width: 8px;
  height: 8px;
  background: var(--primary);
  border-radius: 50%;
}

.sidebar button:hover {
  background: var(--gradient-primary);
  transform: translateX(5px);
  box-shadow: var(--shadow-glow);
}

.sidebar button.ai-btn {
  border-color: var(--primary-light);
  background: rgba(176, 0, 0, 0.1);
}

.sidebar button.ai-btn:hover {
  background: var(--gradient-primary);
  box-shadow: 0 0 15px rgba(255, 51, 51, 0.5);
}

/* ======= √ÅREA PRINCIPAL ======= */
.main {
  flex: 1;
  background: var(--dark);
  border-radius: 15px;
  padding: 25px;
  overflow: auto;
  box-shadow: var(--shadow);
  border: 1px solid rgba(176, 0, 0, 0.2);
}

/* ======= P√ÅGINA DA IA ======= */
.ai-page {
  max-width: 100%;
}

.ai-header {
  display: flex;
  align-items: center;
  gap: 15px;
  margin-bottom: 25px;
  padding-bottom: 15px;
  border-bottom: 1px solid rgba(176, 0, 0, 0.3);
}

.ai-header h2 {
  background: var(--gradient-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-size: 2rem;
  font-weight: 700;
}

.ai-status {
  background: rgba(0, 204, 136, 0.1);
  color: var(--success);
  padding: 5px 12px;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 600;
  border: 1px solid var(--success);
}

.ai-container {
  display: grid;
  grid-template-columns: 1fr 300px;
  gap: 25px;
  height: calc(100vh - 200px);
}

@media (max-width: 1024px) {
  .ai-container {
    grid-template-columns: 1fr;
    height: auto;
  }
}

/* ======= CHAT PRINCIPAL ======= */
.chat-main {
  display: flex;
  flex-direction: column;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 15px;
  border: 1px solid rgba(176, 0, 0, 0.2);
  overflow: hidden;
}

.chat-messages {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 15px;
  max-height: 500px;
}

.message {
  display: flex;
  gap: 12px;
  animation: messageAppear 0.3s ease-out;
}

@keyframes messageAppear {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.message-ai {
  align-items: flex-start;
}

.message-user {
  align-items: flex-end;
  flex-direction: row-reverse;
}

.message-avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  font-size: 1.2rem;
}

.message-avatar.ai {
  background: var(--gradient-primary);
}

.message-avatar.user {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(176, 0, 0, 0.5);
}

.message-content {
  max-width: 70%;
  padding: 15px;
  border-radius: 15px;
  font-size: 0.95rem;
  line-height: 1.5;
  box-shadow: var(--shadow);
}

.message-ai .message-content {
  background: rgba(176, 0, 0, 0.1);
  border: 1px solid rgba(176, 0, 0, 0.3);
  color: #e0e0e0;
  border-bottom-left-radius: 5px;
}

.message-user .message-content {
  background: rgba(30, 30, 30, 0.8);
  border: 1px solid rgba(255, 255, 255, 0.1);
  color: #e0e0e0;
  border-bottom-right-radius: 5px;
}

.message-typing {
  display: flex;
  gap: 5px;
  padding: 15px;
  align-items: center;
}

.message-typing span {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--primary-light);
  animation: typing 1.4s infinite;
}

.message-typing span:nth-child(2) { animation-delay: 0.2s; }
.message-typing span:nth-child(3) { animation-delay: 0.4s; }

@keyframes typing {
  0%, 60%, 100% { transform: translateY(0); }
  30% { transform: translateY(-8px); }
}

.chat-input-container {
  padding: 20px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  display: flex;
  gap: 12px;
  background: rgba(0, 0, 0, 0.5);
}

.chat-input {
  flex: 1;
  padding: 15px 20px;
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(176, 0, 0, 0.3);
  color: white;
  border-radius: 10px;
  font-size: 1rem;
  transition: all 0.3s ease;
}

.chat-input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(176, 0, 0, 0.2);
}

.chat-send-btn {
  background: var(--gradient-primary);
  border: none;
  color: white;
  padding: 15px 25px;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 8px;
  min-width: 120px;
  justify-content: center;
}

.chat-send-btn:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: var(--shadow-glow);
}

.chat-send-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* ======= SIDEBAR DA IA ======= */
.ai-sidebar {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 15px;
  border: 1px solid rgba(176, 0, 0, 0.2);
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.ai-info-card {
  background: rgba(176, 0, 0, 0.1);
  border: 1px solid rgba(176, 0, 0, 0.3);
  border-radius: 10px;
  padding: 20px;
}

.ai-info-card h3 {
  color: var(--primary-light);
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.ai-stats {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.ai-stat {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.ai-stat:last-child {
  border-bottom: none;
}

.stat-label {
  color: var(--gray-light);
  font-size: 0.9rem;
}

.stat-value {
  color: var(--primary-light);
  font-weight: 600;
  font-size: 0.9rem;
}

.quick-actions {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.quick-action-btn {
  background: rgba(176, 0, 0, 0.1);
  border: 1px solid rgba(176, 0, 0, 0.3);
  color: white;
  padding: 12px 15px;
  border-radius: 10px;
  cursor: pointer;
  text-align: left;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 10px;
}

.quick-action-btn:hover {
  background: rgba(176, 0, 0, 0.2);
  transform: translateX(5px);
  border-color: var(--primary);
}

.ai-settings {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.setting-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.setting-label {
  color: var(--gray-light);
  font-size: 0.9rem;
}

.toggle-switch {
  position: relative;
  display: inline-block;
  width: 50px;
  height: 24px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(255, 255, 255, 0.1);
  transition: .4s;
  border-radius: 24px;
}

.toggle-slider:before {
  position: absolute;
  content: "";
  height: 16px;
  width: 16px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  transition: .4s;
  border-radius: 50%;
}

input:checked + .toggle-slider {
  background-color: var(--primary);
}

input:checked + .toggle-slider:before {
  transform: translateX(26px);
}

/* ======= BOX DE LOGIN/REGISTRO ======= */
.box {
  max-width: 420px;
  margin: 0 auto;
  background: var(--card-bg);
  border: 1px solid rgba(176, 0, 0, 0.3);
  padding: 30px;
  border-radius: 15px;
  box-shadow: var(--shadow);
  backdrop-filter: blur(5px);
}

.box h2 {
  color: #fff;
  margin-bottom: 25px;
  text-align: center;
  font-size: 1.8rem;
  font-weight: 600;
  letter-spacing: 1px;
}

.box input {
  width: 100%;
  padding: 14px 18px;
  margin: 12px 0;
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid rgba(255, 255, 255, 0.1);
  color: #fff;
  border-radius: 10px;
  font-size: 1rem;
  transition: all 0.3s ease;
}

.box input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 2px rgba(176, 0, 0, 0.2);
}

.box button {
  width: 100%;
  padding: 14px;
  background: var(--gradient-primary);
  border: none;
  border-radius: 10px;
  cursor: pointer;
  color: white;
  font-weight: 600;
  font-size: 1rem;
  letter-spacing: 0.5px;
  margin-top: 10px;
  transition: all 0.3s ease;
}

.box button:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-glow);
}

/* ======= TERMINAL ======= */
.terminal {
  background: rgba(0, 0, 0, 0.7);
  border: 1px solid rgba(176, 0, 0, 0.3);
  padding: 20px;
  margin-bottom: 20px;
  min-height: 160px;
  max-height: 200px;
  overflow: auto;
  border-radius: 10px;
  font-family: 'Courier New', monospace;
  font-size: 0.9rem;
  box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
}

.terminal span {
  color: var(--primary-light);
  display: block;
  margin-bottom: 5px;
  word-break: break-word;
}

/* ======= INFO DO DISPOSITIVO NO TERMINAL ======= */
.device-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 10px;
  margin-bottom: 20px;
  background: rgba(176, 0, 0, 0.1);
  padding: 15px;
  border-radius: 10px;
  border-left: 4px solid var(--primary);
}

.device-stat {
  display: flex;
  flex-direction: column;
  gap: 5px;
}

.device-stat-label {
  font-size: 0.8rem;
  color: var(--gray-light);
}

.device-stat-value {
  font-weight: 600;
  color: var(--primary-light);
  font-size: 0.9rem;
}

/* ======= CARDS DO PAINEL ======= */
.cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 20px;
  margin-top: 25px;
}

.card {
  background: var(--card-bg);
  border: 1px solid rgba(176, 0, 0, 0.2);
  padding: 20px;
  border-radius: 15px;
  transition: all 0.3s ease;
  backdrop-filter: blur(5px);
}

.card:hover {
  transform: translateY(-5px);
  border-color: var(--primary);
  box-shadow: var(--shadow-glow);
}

.card h3 {
  color: #fff;
  margin-bottom: 15px;
  font-size: 1.2rem;
  display: flex;
  align-items: center;
  gap: 10px;
}

.card button {
  width: 100%;
  margin-top: 15px;
  padding: 12px;
  background: transparent;
  border: 1px solid var(--primary);
  color: #fff;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 500;
  transition: all 0.3s ease;
}

.card button:hover {
  background: var(--gradient-primary);
  box-shadow: var(--shadow-glow);
}

/* ======= INFO DO USU√ÅRIO ======= */
#painelBox > p {
  background: rgba(176, 0, 0, 0.1);
  padding: 12px 20px;
  border-radius: 10px;
  margin-bottom: 20px;
  border-left: 4px solid var(--primary);
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  align-items: center;
}

#userName, #userRole {
  color: var(--primary-light);
}

/* ======= BOT√ÉO EXPORTAR ======= */
#painelBox > button:last-child {
  background: var(--gradient-dark);
  border: 1px solid var(--gray);
  color: #fff;
  padding: 14px 25px;
  border-radius: 10px;
  cursor: pointer;
  margin-top: 25px;
  font-weight: 500;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  width: 100%;
  max-width: 300px;
}

#painelBox > button:last-child:hover {
  border-color: var(--primary);
  background: rgba(176, 0, 0, 0.1);
  box-shadow: var(--shadow-glow);
}

/* ======= MODAL ======= */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.8);
  display: none;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(5px);
  z-index: 2000;
  padding: 20px;
}

.modal .content {
  background: var(--modal-bg);
  border: 1px solid var(--primary);
  padding: 25px;
  width: 500px;
  max-width: 100%;
  border-radius: 15px;
  box-shadow: var(--shadow-glow);
  animation: modalAppear 0.3s ease-out;
  max-height: 90vh;
  overflow-y: auto;
}

@keyframes modalAppear {
  from {
    opacity: 0;
    transform: translateY(-30px) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.modal h3 {
  color: var(--primary-light);
  margin-bottom: 20px;
  font-size: 1.5rem;
  border-bottom: 1px solid rgba(176, 0, 0, 0.3);
  padding-bottom: 10px;
}

.modal button {
  background: var(--gradient-primary);
  border: none;
  color: white;
  padding: 12px 24px;
  border-radius: 10px;
  cursor: pointer;
  font-weight: 500;
  margin-top: 20px;
  transition: all 0.3s ease;
  width: 100%;
}

.modal button:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-glow);
}

/* ======= CHART ======= */
#chart {
  background: rgba(0, 0, 0, 0.5);
  border: 1px solid rgba(176, 0, 0, 0.3);
  margin-top: 20px;
  border-radius: 10px;
  width: 100%;
  max-width: 100%;
}

/* ======= FOOTER ======= */
footer {
  text-align: center;
  color: var(--gray);
  padding: 15px;
  font-size: 0.9rem;
  border-top: 1px solid rgba(176, 0, 0, 0.1);
  background: var(--dark);
  margin-top: auto;
}

/* ======= UTILIT√ÅRIOS ======= */
.hidden {
  display: none !important;
}

.admin {
  border: 1px solid var(--warning);
}

.admin h3 {
  color: var(--warning) !important;
}

.admin button {
  border-color: var(--warning) !important;
}

.admin button:hover {
  background: linear-gradient(135deg, #ffaa00 0%, #ffcc00 100%) !important;
}

/* ======= ANIMA√á√ïES ======= */
@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0.4); }
  70% { box-shadow: 0 0 0 10px rgba(0, 255, 0, 0); }
  100% { box-shadow: 0 0 0 0 rgba(0, 255, 0, 0); }
}

@keyframes slideIn {
  from {
    transform: translateX(-100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

.pulse {
  animation: pulse 2s infinite;
}

/* ======= SCROLLBAR PERSONALIZADA ======= */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 10px;
}

::-webkit-scrollbar-thumb {
  background: var(--primary);
  border-radius: 10px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--primary-light);
}

/* ======= RESPONSIVIDADE - TABLET ======= */
@media (max-width: 1024px) {
  .wrapper {
    flex-direction: column;
    height: auto;
    min-height: calc(100vh - 70px);
  }
  
  .sidebar {
    width: 100%;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: center;
    padding: 15px;
  }
  
  .sidebar button {
    flex: 1;
    min-width: 160px;
    justify-content: center;
    padding: 12px;
  }
  
  .cards {
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  }
  
  .device-info {
    display: block;
  }
  
  .ai-container {
    grid-template-columns: 1fr;
    gap: 20px;
  }
}

/* ======= RESPONSIVIDADE - MOBILE ======= */
@media (max-width: 768px) {
  header {
    padding: 0 15px;
    height: 60px;
  }
  
  header h1 {
    font-size: 1.4rem;
  }
  
  .logo-container h1 {
    font-size: 1.2rem;
  }
  
  .menu-toggle {
    display: block;
  }
  
  .sidebar {
    position: fixed;
    top: 70px;
    left: 0;
    width: 280px;
    height: calc(100vh - 70px);
    transform: translateX(-100%);
    z-index: 999;
    padding: 20px;
    flex-direction: column;
    overflow-y: auto;
  }
  
  .sidebar.active {
    transform: translateX(0);
  }
  
  .sidebar-overlay {
    position: fixed;
    top: 70px;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(5px);
    z-index: 998;
    display: none;
  }
  
  .sidebar-overlay.active {
    display: block;
  }
  
  .sidebar button {
    min-width: 100%;
    justify-content: flex-start;
  }
  
  .main {
    padding: 15px;
  }
  
  .box {
    padding: 20px;
  }
  
  .cards {
    grid-template-columns: 1fr;
  }
  
  .device-badge {
    top: 75px;
    right: 15px;
    font-size: 0.6rem;
    padding: 4px 8px;
  }
  
  .modal .content {
    padding: 20px;
    width: 95%;
  }
  
  #chart {
    height: 100px;
  }
  
  .terminal {
    min-height: 120px;
    max-height: 150px;
    font-size: 0.8rem;
    padding: 15px;
  }
  
  .device-stats {
    grid-template-columns: 1fr;
    padding: 10px;
    gap: 8px;
  }
  
  #painelBox > p {
    flex-direction: column;
    align-items: flex-start;
    gap: 5px;
    padding: 10px 15px;
  }
  
  .ai-header {
    flex-direction: column;
    text-align: center;
    gap: 10px;
  }
  
  .ai-header h2 {
    font-size: 1.5rem;
  }
  
  .message-content {
    max-width: 85%;
    font-size: 0.9rem;
    padding: 12px;
  }
  
  .message-avatar {
    width: 35px;
    height: 35px;
    font-size: 1rem;
  }
  
  .chat-input-container {
    padding: 15px;
    flex-direction: column;
  }
  
  .chat-send-btn {
    width: 100%;
    padding: 12px;
  }
}

/* ======= RESPONSIVIDADE - SMALL MOBILE ======= */
@media (max-width: 480px) {
  header {
    padding: 0 10px;
  }
  
  header h1 {
    font-size: 1.2rem;
  }
  
  header img {
    width: 35px;
  }
  
  .box {
    padding: 15px;
    margin: 0 10px;
  }
  
  .box h2 {
    font-size: 1.5rem;
  }
  
  .box input {
    padding: 12px 15px;
  }
  
  .card {
    padding: 15px;
  }
  
  .card h3 {
    font-size: 1.1rem;
  }
  
  .device-badge {
    font-size: 0.55rem;
    padding: 3px 6px;
  }
  
  .wrapper {
    padding: 10px;
  }
  
  .main {
    padding: 10px;
  }
  
  .message-content {
    max-width: 90%;
    font-size: 0.85rem;
  }
}

/* ======= DARK OVERLAY FOR MOBILE MENU ======= */
.overlay {
  display: none;
  position: fixed;
  top: 70px;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.7);
  backdrop-filter: blur(5px);
  z-index: 998;
}

.overlay.active {
  display: block;
}

/* ======= TOUCH-FRIENDLY ELEMENTS ======= */
@media (hover: none) and (pointer: coarse) {
  .sidebar button,
  .card button,
  .box button,
  .modal button,
  .chat-send-btn,
  .quick-action-btn {
    min-height: 44px;
  }
  
  input, button {
    font-size: 16px !important; /* Prevents zoom on iOS */
  }
  
  .chat-input,
  .chat-send-btn {
    min-height: 44px;
  }
}
</style>
</head>

<body>
<header>
  <div class="logo-container">
    <h1>NEMO SYSTEM</h1>
    <div class="device-info" id="deviceInfo"></div>
  </div>
  <button class="menu-toggle" id="menuToggle">‚ò∞</button>
  <img src="https://cdn-icons-png.flaticon.com/512/924/924915.png" alt="Logo Nemo">
</header>

<div class="device-badge" id="deviceBadge">
  <span id="deviceType">Carregando...</span>
</div>

<div class="wrapper">
  <div class="overlay" id="overlay"></div>
  <div class="sidebar" id="sidebar">
    <button id="loginBtn" onclick="showLogin()">üîê Login</button>
    <button id="registerBtn" onclick="showRegister()">üìù Registrar</button>
    <button id="painelBtn" onclick="openPainel()">üñ•Ô∏è Painel Nemo</button>
    <button id="aiBtn" onclick="openAIPage()" class="ai-btn">ü§ñ Nemo AI</button>
    <button id="logoutBtn" onclick="logout()">üö™ Logout</button>
  </div>

  <div class="main">
    <!-- P√°gina de Login -->
    <div id="loginBox" class="box">
      <h2>Login</h2>
      <input id="lUser" placeholder="Usu√°rio">
      <input id="lPass" type="password" placeholder="Senha">
      <button onclick="login()">Entrar</button>
    </div>

    <!-- P√°gina de Registro -->
    <div id="registerBox" class="box hidden">
      <h2>Registro</h2>
      <input id="rUser" placeholder="Usu√°rio">
      <input id="rPass" type="password" placeholder="Senha">
      <button onclick="register()">Criar Conta</button>
    </div>

    <!-- Painel Principal -->
    <div id="painelBox" class="hidden">
      <div class="terminal" id="terminal"></div>
      
      <div class="device-stats" id="deviceStats">
        <!-- Device info will be populated here -->
      </div>
      
      <p>Usu√°rio: <b><span id="userName"></span></b> | Role: <b><span id="userRole"></span></b></p>

      <canvas id="chart" width="400" height="120"></canvas>

      <div class="cards">
        <div class="card"><h3>üîç Scanner</h3><button onclick="openModal('scanner')">Abrir</button></div>
        <div class="card"><h3>üì° Network</h3><button onclick="openModal('network')">Abrir</button></div>
        <div class="card"><h3>üõ† Tools</h3><button onclick="openModal('tools')">Abrir</button></div>
        <div class="card"><h3>‚öô Config</h3><button onclick="openModal('config')">Abrir</button></div>
        <div class="card admin"><h3>üëë Admin</h3><button onclick="openModal('admin')">Abrir</button></div>
      </div>

      <br>
      <button onclick="exportLogs()">üìÅ Exportar Logs (CSV)</button>
    </div>

    <!-- P√°gina da IA -->
    <div id="aiPage" class="ai-page hidden">
      <div class="ai-header">
        <h2><i class="fas fa-robot"></i> Nemo AI Assistant</h2>
        <div class="ai-status" id="aiStatus">
          <i class="fas fa-circle"></i> Online
        </div>
      </div>
      
      <div class="ai-container">
        <div class="chat-main">
          <div class="chat-messages" id="chatMessages">
            <!-- Mensagens ser√£o adicionadas aqui -->
          </div>
          <div class="chat-input-container">
            <input type="text" class="chat-input" id="chatInput" placeholder="Digite sua mensagem para a IA..." maxlength="500">
            <button class="chat-send-btn" id="sendMessageBtn" onclick="sendAIMessage()">
              <i class="fas fa-paper-plane"></i> Enviar
            </button>
          </div>
        </div>
        
        <div class="ai-sidebar">
          <div class="ai-info-card">
            <h3><i class="fas fa-info-circle"></i> Sobre a IA</h3>
            <div class="ai-stats">
              <div class="ai-stat">
                <span class="stat-label">Modelo:</span>
                <span class="stat-value" id="aiModel">Gemini Pro</span>
              </div>
              <div class="ai-stat">
                <span class="stat-label">Status:</span>
                <span class="stat-value" id="aiConnection">Online</span>
              </div>
              <div class="ai-stat">
                <span class="stat-label">Mensagens:</span>
                <span class="stat-value" id="messageCount">0</span>
              </div>
              <div class="ai-stat">
                <span class="stat-label">Contexto:</span>
                <span class="stat-value">10 itens</span>
              </div>
            </div>
          </div>
          
          <div class="ai-info-card">
            <h3><i class="fas fa-bolt"></i> A√ß√µes R√°pidas</h3>
            <div class="quick-actions">
              <button class="quick-action-btn" onclick="sendQuickAIMessage('Como usar o scanner de portas?')">
                <i class="fas fa-search"></i> Como usar o Scanner?
              </button>
              <button class="quick-action-btn" onclick="sendQuickAIMessage('Explicar o painel administrativo')">
                <i class="fas fa-crown"></i> Painel Admin
              </button>
              <button class="quick-action-btn" onclick="sendQuickAIMessage('Quais comandos est√£o dispon√≠veis?')">
                <i class="fas fa-terminal"></i> Comandos do Sistema
              </button>
              <button class="quick-action-btn" onclick="sendQuickAIMessage('O que √© o Nemo System?')">
                <i class="fas fa-question-circle"></i> Sobre o Nemo
              </button>
            </div>
          </div>
          
          <div class="ai-info-card">
            <h3><i class="fas fa-cog"></i> Configura√ß√µes</h3>
            <div class="ai-settings">
              <div class="setting-item">
                <span class="setting-label">Modo Noturno</span>
                <label class="toggle-switch">
                  <input type="checkbox" id="darkModeToggle" checked>
                  <span class="toggle-slider"></span>
                </label>
              </div>
              <div class="setting-item">
                <span class="setting-label">Som de Notifica√ß√£o</span>
                <label class="toggle-switch">
                  <input type="checkbox" id="soundToggle" checked>
                  <span class="toggle-slider"></span>
                </label>
              </div>
              <div class="setting-item">
                <span class="setting-label">Hist√≥rico de Chat</span>
                <label class="toggle-switch">
                  <input type="checkbox" id="historyToggle" checked>
                  <span class="toggle-slider"></span>
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<footer>Nemo System ¬© 2026 | <span id="connectionType">Detectando conex√£o...</span></footer>

<!-- MODAL -->
<div id="modal" class="modal">
  <div class="content">
    <h3 id="modalTitle"></h3>
    <div id="modalBody"></div>
    <button onclick="closeModal()">Fechar</button>
  </div>
</div>

<script>
/* ======= CONFIGURA√á√ÉO DA IA ======= */
const AI_CONFIG = {
  API_KEY: 'AIzaSyB0g5LfKg_nyNp5hC_ZDduEanZ0ySUNk8E',
  API_URL: 'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent',
  
  FALLBACK_RESPONSES: [
    "Ol√°! Sou o Nemo AI, seu assistente no Nemo System. Como posso ajudar?",
    "Para usar o scanner, v√° para a se√ß√£o Scanner no painel principal.",
    "O painel admin √© acess√≠vel apenas para o usu√°rio 'Nemo' com senha 'gustavo270908'.",
    "Voc√™ pode exportar logs clicando no bot√£o 'Exportar Logs' no painel.",
    "O Nemo System √© uma plataforma completa de administra√ß√£o com v√°rias ferramentas √∫teis."
  ],
  
  SYSTEM_CONTEXT: `Voc√™ √© o Nemo AI, assistente virtual especializado no Nemo System - uma plataforma de administra√ß√£o completa.

SISTEMA NEMO:
- Autentica√ß√£o segura com hash SHA256
- Painel administrativo com gr√°ficos em tempo real
- Terminal de comandos integrado
- Scanner de portas (21, 22, 80, 443)
- Ferramentas de rede (ping, testes)
- Gerador de senhas seguras
- Sistema de logs e exporta√ß√£o CSV
- Interface responsiva para desktop/mobile
- Modera√ß√£o de usu√°rios (banir/desbanir)

FUNCIONALIDADES:
1. Scanner: Verifica status das portas principais
2. Network: Testa lat√™ncia e conectividade
3. Tools: Gera senhas e hashes SHA256
4. Config: Alterna temas (vermelho/verde/laranja)
5. Admin: Gerencia usu√°rios e permiss√µes

COMANDOS:
- scan(): Inicia verifica√ß√£o de portas
- ping(): Testa conex√£o de rede
- gen(): Gera senha segura com hash
- toggle(): Muda tema do sistema
- exportLogs(): Exporta hist√≥rico em CSV

USU√ÅRIO ADMIN:
- Nome: Nemo
- Senha: gustavo270908
- Permiss√µes: Acesso total ao sistema

Seja √∫til, educado e forne√ßa informa√ß√µes claras sobre o sistema. Se n√£o souber algo, seja honesto e ofere√ßa ajuda em outra √°rea.`
};

/* ======= DETEC√á√ÉO DE DISPOSITIVO ======= */
class DeviceDetector {
  constructor() {
    this.deviceInfo = {
      type: 'desktop',
      os: 'Unknown',
      browser: 'Unknown',
      screenSize: 'Unknown',
      orientation: 'portrait',
      touch: false,
      connection: 'Unknown',
      platform: 'Unknown',
      language: 'Unknown',
      timezone: 'Unknown'
    };
    this.init();
  }

  init() {
    this.detectDeviceType();
    this.detectOS();
    this.detectBrowser();
    this.detectScreen();
    this.detectTouch();
    this.detectConnection();
    this.detectPlatform();
    this.detectLanguage();
    this.detectTimezone();
    this.updateUI();
  }

  detectDeviceType() {
    const userAgent = navigator.userAgent.toLowerCase();
    const isMobile = /mobile|iphone|ipod|android|blackberry|mini|windows\s+ce|palm|smartphone|webos/i.test(userAgent);
    const isTablet = /tablet|ipad|playbook|silk/i.test(userAgent);
    
    if (isMobile) this.deviceInfo.type = 'mobile';
    else if (isTablet) this.deviceInfo.type = 'tablet';
    else this.deviceInfo.type = 'desktop';
  }

  detectOS() {
    const userAgent = navigator.userAgent;
    if (userAgent.indexOf("Win") !== -1) this.deviceInfo.os = "Windows";
    else if (userAgent.indexOf("Mac") !== -1) this.deviceInfo.os = "macOS";
    else if (userAgent.indexOf("Linux") !== -1) this.deviceInfo.os = "Linux";
    else if (userAgent.indexOf("Android") !== -1) this.deviceInfo.os = "Android";
    else if (userAgent.indexOf("iOS") !== -1 || /iPad|iPhone|iPod/.test(userAgent)) this.deviceInfo.os = "iOS";
    else this.deviceInfo.os = "Unknown OS";
  }

  detectBrowser() {
    const userAgent = navigator.userAgent;
    if (userAgent.indexOf("Chrome") !== -1) this.deviceInfo.browser = "Chrome";
    else if (userAgent.indexOf("Firefox") !== -1) this.deviceInfo.browser = "Firefox";
    else if (userAgent.indexOf("Safari") !== -1) this.deviceInfo.browser = "Safari";
    else if (userAgent.indexOf("Edge") !== -1) this.deviceInfo.browser = "Edge";
    else if (userAgent.indexOf("Opera") !== -1) this.deviceInfo.browser = "Opera";
    else this.deviceInfo.browser = "Unknown Browser";
  }

  detectScreen() {
    this.deviceInfo.screenSize = `${window.screen.width} √ó ${window.screen.height}`;
    this.deviceInfo.orientation = window.innerWidth > window.innerHeight ? 'landscape' : 'portrait';
    
    window.addEventListener('resize', () => {
      this.deviceInfo.screenSize = `${window.screen.width} √ó ${window.screen.height}`;
      this.deviceInfo.orientation = window.innerWidth > window.innerHeight ? 'landscape' : 'portrait';
      this.updateUI();
    });
    
    window.addEventListener('orientationchange', () => {
      setTimeout(() => {
        this.deviceInfo.orientation = window.innerWidth > window.innerHeight ? 'landscape' : 'portrait';
        this.updateUI();
      }, 100);
    });
  }

  detectTouch() {
    this.deviceInfo.touch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;
  }

  detectConnection() {
    if (navigator.connection) {
      const connection = navigator.connection;
      this.deviceInfo.connection = connection.effectiveType || 'Unknown';
      
      connection.addEventListener('change', () => {
        this.deviceInfo.connection = connection.effectiveType || 'Unknown';
        this.updateUI();
      });
    } else {
      this.deviceInfo.connection = 'Ethernet/WiFi';
    }
  }

  detectPlatform() {
    this.deviceInfo.platform = navigator.platform || 'Unknown';
  }

  detectLanguage() {
    this.deviceInfo.language = navigator.language || 'Unknown';
  }

  detectTimezone() {
    this.deviceInfo.timezone = Intl.DateTimeFormat().resolvedOptions().timeZone || 'Unknown';
  }

  updateUI() {
    const badge = document.getElementById('deviceBadge');
    const deviceType = document.getElementById('deviceType');
    
    if (badge && deviceType) {
      let typeText = '';
      let typeIcon = '';
      
      switch(this.deviceInfo.type) {
        case 'mobile':
          typeText = 'üì± Mobile';
          typeIcon = 'üì±';
          break;
        case 'tablet':
          typeText = 'üìü Tablet';
          typeIcon = 'üìü';
          break;
        default:
          typeText = 'üñ•Ô∏è Desktop';
          typeIcon = 'üñ•Ô∏è';
      }
      
      deviceType.textContent = `${typeIcon} ${typeText} | ${this.deviceInfo.os}`;
      
      const connectionSpan = document.getElementById('connectionType');
      if (connectionSpan) {
        connectionSpan.textContent = `Conex√£o: ${this.deviceInfo.connection}`;
      }
    }
    
    const deviceInfoDiv = document.getElementById('deviceInfo');
    if (deviceInfoDiv) {
      deviceInfoDiv.textContent = `${this.deviceInfo.type} | ${this.deviceInfo.os}`;
    }
    
    this.updateDeviceStats();
    
    if (typeof log === 'function') {
      log(`Dispositivo: ${this.deviceInfo.type} | OS: ${this.deviceInfo.os} | Navegador: ${this.deviceInfo.browser}`);
      log(`Tela: ${this.deviceInfo.screenSize} | Orienta√ß√£o: ${this.deviceInfo.orientation}`);
      log(`Touch: ${this.deviceInfo.touch ? 'Sim' : 'N√£o'} | Conex√£o: ${this.deviceInfo.connection}`);
    }
  }

  updateDeviceStats() {
    const statsContainer = document.getElementById('deviceStats');
    if (!statsContainer) return;
    
    statsContainer.innerHTML = `
      <div class="device-stat">
        <span class="device-stat-label">üì± Dispositivo</span>
        <span class="device-stat-value">${this.deviceInfo.type.toUpperCase()}</span>
      </div>
      <div class="device-stat">
        <span class="device-stat-label">‚öôÔ∏è Sistema</span>
        <span class="device-stat-value">${this.deviceInfo.os}</span>
      </div>
      <div class="device-stat">
        <span class="device-stat-label">üåê Navegador</span>
        <span class="device-stat-value">${this.deviceInfo.browser}</span>
      </div>
      <div class="device-stat">
        <span class="device-stat-label">üìè Resolu√ß√£o</span>
        <span class="device-stat-value">${this.deviceInfo.screenSize}</span>
      </div>
      <div class="device-stat">
        <span class="device-stat-label">üì∂ Conex√£o</span>
        <span class="device-stat-value">${this.deviceInfo.connection}</span>
      </div>
      <div class="device-stat">
        <span class="device-stat-label">üìç Idioma</span>
        <span class="device-stat-value">${this.deviceInfo.language}</span>
      </div>
      <div class="device-stat">
        <span class="device-stat-label">üïê Fuso Hor√°rio</span>
        <span class="device-stat-value">${this.deviceInfo.timezone}</span>
      </div>
      <div class="device-stat">
        <span class="device-stat-label">üëÜ Touch</span>
        <span class="device-stat-value">${this.deviceInfo.touch ? 'Sim' : 'N√£o'}</span>
      </div>
    `;
  }

  getDeviceInfo() {
    return this.deviceInfo;
  }
}

/* ======= IA CHAT ======= */
class NemoAIAssistant {
  constructor() {
    this.messages = [];
    this.conversationHistory = [];
    this.isThinking = false;
    this.messageCount = 0;
    this.isOnline = true;
    this.init();
  }

  init() {
    this.setupEventListeners();
    this.addWelcomeMessage();
    this.updateStats();
    this.setupSettings();
  }

  setupEventListeners() {
    const input = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendMessageBtn');
    
    if (input) {
      input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' && !this.isThinking) {
          this.sendMessage();
        }
      });
      
      input.addEventListener('input', () => {
        this.updateSendButton();
      });
    }
    
    if (sendBtn) {
      sendBtn.addEventListener('click', () => this.sendMessage());
    }
  }

  setupSettings() {
    const darkModeToggle = document.getElementById('darkModeToggle');
    const soundToggle = document.getElementById('soundToggle');
    const historyToggle = document.getElementById('historyToggle');
    
    if (darkModeToggle) {
      darkModeToggle.addEventListener('change', (e) => {
        document.body.classList.toggle('dark-mode', e.target.checked);
        localStorage.setItem('aiDarkMode', e.target.checked);
      });
      
      // Load saved setting
      const savedDarkMode = localStorage.getItem('aiDarkMode') !== 'false';
      darkModeToggle.checked = savedDarkMode;
      document.body.classList.toggle('dark-mode', savedDarkMode);
    }
    
    if (soundToggle) {
      soundToggle.addEventListener('change', (e) => {
        localStorage.setItem('aiSound', e.target.checked);
      });
      
      const savedSound = localStorage.getItem('aiSound') !== 'false';
      soundToggle.checked = savedSound;
    }
    
    if (historyToggle) {
      historyToggle.addEventListener('change', (e) => {
        localStorage.setItem('aiHistory', e.target.checked);
      });
      
      const savedHistory = localStorage.getItem('aiHistory') !== 'false';
      historyToggle.checked = savedHistory;
    }
  }

  addWelcomeMessage() {
    const welcomeMessage = `üëã **Ol√°! Eu sou o Nemo AI**, seu assistente virtual no **Nemo System**!

üéØ **Posso ajudar voc√™ com:**
- **Explicar todas as funcionalidades do sistema**
- **Ajudar com comandos e configura√ß√µes**
- **Responder perguntas t√©cnicas**
- **Conversar sobre qualquer assunto**
- **Resolver problemas de uso**

üí° **Dica r√°pida:** Experimente usar os bot√µes de a√ß√µes r√°pidas ao lado para perguntas comuns!

**Como posso ser √∫til para voc√™ hoje?** üòä`;

    this.addMessage('ai', welcomeMessage);
  }

  addMessage(sender, text) {
    const messagesContainer = document.getElementById('chatMessages');
    if (!messagesContainer) return;

    const messageDiv = document.createElement('div');
    messageDiv.className = `message message-${sender}`;
    
    const avatar = sender === 'ai' 
      ? '<i class="fas fa-robot"></i>'
      : '<i class="fas fa-user"></i>';
    
    messageDiv.innerHTML = `
      <div class="message-avatar ${sender}">${avatar}</div>
      <div class="message-content">${this.formatMessage(text)}</div>
    `;
    
    messagesContainer.appendChild(messageDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
    
    // Salvar no hist√≥rico
    this.conversationHistory.push({
      role: sender === 'ai' ? 'assistant' : 'user',
      content: text,
      timestamp: new Date().toISOString()
    });
    
    // Incrementar contador
    if (sender === 'user') {
      this.messageCount++;
      this.updateStats();
    }
    
    // Limitar hist√≥rico
    if (this.conversationHistory.length > 50) {
      this.conversationHistory = this.conversationHistory.slice(-50);
    }
  }

  addTypingIndicator() {
    const messagesContainer = document.getElementById('chatMessages');
    if (!messagesContainer) return;

    const typingDiv = document.createElement('div');
    typingDiv.className = 'message message-ai';
    typingDiv.id = 'typingIndicator';
    typingDiv.innerHTML = `
      <div class="message-avatar ai"><i class="fas fa-robot"></i></div>
      <div class="message-typing">
        <span></span><span></span><span></span>
      </div>
    `;
    
    messagesContainer.appendChild(typingDiv);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
  }

  removeTypingIndicator() {
    const typingIndicator = document.getElementById('typingIndicator');
    if (typingIndicator) {
      typingIndicator.remove();
    }
  }

  formatMessage(text) {
    return text
      .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
      .replace(/\n/g, '<br>')
      .replace(/`(.*?)`/g, '<code>$1</code>')
      .replace(/- (.*?)(?=\n|$)/g, '<br>‚Ä¢ $1')
      .replace(/üéØ/g, '<i class="fas fa-bullseye"></i>')
      .replace(/üí°/g, '<i class="fas fa-lightbulb"></i>')
      .replace(/üëã/g, '<i class="fas fa-hand-wave"></i>')
      .replace(/üòä/g, '<i class="fas fa-smile"></i>');
  }

  async sendMessage() {
    const input = document.getElementById('chatInput');
    if (!input || this.isThinking) return;

    const userMessage = input.value.trim();
    if (!userMessage) return;

    // Adicionar mensagem do usu√°rio
    input.value = '';
    this.addMessage('user', userMessage);
    this.updateSendButton();
    
    // Mostrar indicador de digita√ß√£o
    this.addTypingIndicator();
    this.isThinking = true;
    this.updateConnectionStatus('Pensando...');

    try {
      // Tentar usar a API do Gemini
      const response = await this.callGeminiAPI(userMessage);
      this.removeTypingIndicator();
      this.addMessage('ai', response);
      this.updateConnectionStatus('Online');
    } catch (error) {
      console.error('Erro na API:', error);
      this.removeTypingIndicator();
      
      // Fallback para respostas locais
      const fallbackResponse = this.getFallbackResponse(userMessage);
      this.addMessage('ai', fallbackResponse);
      
      // Atualizar status
      if (!navigator.onLine) {
        this.updateConnectionStatus('Offline');
        this.isOnline = false;
      } else {
        this.updateConnectionStatus('Online (Fallback)');
      }
    } finally {
      this.isThinking = false;
      
      // Focar no input novamente
      setTimeout(() => {
        if (input) input.focus();
      }, 100);
    }
  }

  sendQuickMessage(text) {
    const input = document.getElementById('chatInput');
    if (input) {
      input.value = text;
      this.sendMessage();
    }
  }

  updateSendButton() {
    const input = document.getElementById('chatInput');
    const sendBtn = document.getElementById('sendMessageBtn');
    
    if (input && sendBtn) {
      const hasText = input.value.trim().length > 0;
      sendBtn.disabled = !hasText || this.isThinking;
    }
  }

  updateStats() {
    const messageCountEl = document.getElementById('messageCount');
    if (messageCountEl) {
      messageCountEl.textContent = this.messageCount;
    }
  }

  updateConnectionStatus(status) {
    const statusEl = document.getElementById('aiStatus');
    const connectionEl = document.getElementById('aiConnection');
    
    if (statusEl) {
      statusEl.innerHTML = `<i class="fas fa-circle"></i> ${status}`;
      
      // Mudar cor baseada no status
      if (status.includes('Offline')) {
        statusEl.style.background = 'rgba(255, 0, 0, 0.1)';
        statusEl.style.borderColor = '#ff0000';
        statusEl.style.color = '#ff6666';
      } else if (status.includes('Pensando')) {
        statusEl.style.background = 'rgba(255, 204, 0, 0.1)';
        statusEl.style.borderColor = '#ffcc00';
        statusEl.style.color = '#ffdb4d';
      } else {
        statusEl.style.background = 'rgba(0, 204, 136, 0.1)';
        statusEl.style.borderColor = '#00cc88';
        statusEl.style.color = '#00cc88';
      }
    }
    
    if (connectionEl) {
      connectionEl.textContent = status;
    }
  }

  async callGeminiAPI(userMessage) {
    if (!navigator.onLine) {
      throw new Error('Sem conex√£o com a internet');
    }

    const messagesForAPI = [
      {
        role: 'user',
        parts: [{ text: AI_CONFIG.SYSTEM_CONTEXT }]
      },
      {
        role: 'model',
        parts: [{ text: 'Entendido! Sou o Nemo AI, especialista no Nemo System. Estou pronto para ajudar com qualquer d√∫vida sobre o sistema.' }]
      }
    ];

    const recentHistory = this.conversationHistory.slice(-8);
    recentHistory.forEach(msg => {
      messagesForAPI.push({
        role: msg.role,
        parts: [{ text: msg.content }]
      });
    });

    messagesForAPI.push({
      role: 'user',
      parts: [{ text: userMessage }]
    });

    try {
      const response = await fetch(
        `${AI_CONFIG.API_URL}?key=${AI_CONFIG.API_KEY}`,
        {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            contents: messagesForAPI,
            generationConfig: {
              temperature: 0.7,
              topK: 1,
              topP: 0.95,
              maxOutputTokens: 1024,
            },
            safetySettings: [
              {
                category: 'HARM_CATEGORY_HARASSMENT',
                threshold: 'BLOCK_MEDIUM_AND_ABOVE'
              },
              {
                category: 'HARM_CATEGORY_HATE_SPEECH',
                threshold: 'BLOCK_MEDIUM_AND_ABOVE'
              },
              {
                category: 'HARM_CATEGORY_SEXUALLY_EXPLICIT',
                threshold: 'BLOCK_MEDIUM_AND_ABOVE'
              },
              {
                category: 'HARM_CATEGORY_DANGEROUS_CONTENT',
                threshold: 'BLOCK_MEDIUM_AND_ABOVE'
              }
            ]
          })
        }
      );

      if (!response.ok) {
        throw new Error(`API error: ${response.status}`);
      }

      const data = await response.json();
      
      if (data.candidates && data.candidates[0] && data.candidates[0].content) {
        return data.candidates[0].content.parts[0].text;
      } else {
        throw new Error('Resposta inv√°lida da API');
      }
    } catch (error) {
      console.warn('API Gemini falhou, usando fallback:', error);
      throw error;
    }
  }

  getFallbackResponse(userMessage) {
    const lowerMessage = userMessage.toLowerCase();
    
    if (lowerMessage.includes('scanner') || lowerMessage.includes('scan')) {
      return `**üîç Scanner de Portas - Nemo System**

O scanner verifica o status das principais portas de rede:

**Portas verificadas:**
- **Porta 21 (FTP)**: Protocolo de transfer√™ncia de arquivos
- **Porta 22 (SSH)**: Conex√£o segura remota
- **Porta 80 (HTTP)**: Protocolo web padr√£o
- **Porta 443 (HTTPS)**: Protocolo web seguro

**Como usar:**
1. V√° para o **Painel Nemo**
2. Clique no card **üîç Scanner**
3. Clique em **"Abrir"**
4. Clique em **"Iniciar Scan"**

**Resultado:** O terminal mostrar√° se cada porta est√° **ABERTA** ou **FECHADA**.

üí° **Dica:** O scanner √© simulado para demonstra√ß√£o, mas mostra como funcionaria um scanner real!`;
    
    } else if (lowerMessage.includes('admin') || lowerMessage.includes('administrador')) {
      return `**üëë Painel Administrativo - Nemo System**

O painel admin √© acess√≠vel **apenas** para o usu√°rio **Nemo**.

**Credenciais padr√£o:**
- **Usu√°rio:** Nemo
- **Senha:** gustavo270908

**Funcionalidades dispon√≠veis:**
- üìã **Listar todos os usu√°rios** registrados no sistema
- üëÅÔ∏è **Visualizar detalhes** de cada usu√°rio
- ‚ö†Ô∏è **Banir/Desbanir** usu√°rios
- üîÑ **Resetar sistema** completo
- üìä **Ver hist√≥rico** de logins de cada usu√°rio

**Como acessar:**
1. Fa√ßa login como **Nemo**
2. No Painel Nemo, clique no card **üëë Admin**
3. Clique em **"Abrir"**

‚ö†Ô∏è **Aten√ß√£o:** Apenas o administrador pode banir/desbanir usu√°rios e resetar o sistema.`;
    
    } else if (lowerMessage.includes('login') || lowerMessage.includes('registrar') || lowerMessage.includes('conta')) {
      return `**üîê Sistema de Autentica√ß√£o - Nemo System**

**1. Criar Conta (Registrar):**
- Clique em **"Registrar"** na sidebar
- Digite um nome de usu√°rio (n√£o pode ser "Nemo")
- Digite uma senha segura
- Clique em **"Criar Conta"**
- ‚ö†Ô∏è O usu√°rio "Nemo" √© reservado para o administrador

**2. Fazer Login:**
- Clique em **"Login"** na sidebar
- Digite seu usu√°rio e senha
- Clique em **"Entrar"**

**Seguran√ßa:**
- Todas as senhas s√£o protegidas com **hash SHA256**
- Nenhuma senha √© armazenada em texto claro
- Cada login √© registrado com data, hora e informa√ß√µes do dispositivo

**Problemas com login?**
- Verifique se digitou o usu√°rio/senha corretamente
- Tente criar uma nova conta se esqueceu as credenciais
- Se banido, entre em contato com o administrador (usu√°rio Nemo)`;
    
    } else if (lowerMessage.includes('comando') || lowerMessage.includes('funciona') || lowerMessage.includes('como usar')) {
      return `**üõ† Comandos do Sistema - Nemo System**

**Ferramentas dispon√≠veis:**

**1. Scanner de Portas**
\`\`\`
scan()
\`\`\`
Verifica portas 21, 22, 80, 443

**2. Teste de Rede**
\`\`\`
ping()
\`\`\`
Mede lat√™ncia da conex√£o

**3. Gerador de Senhas**
\`\`\`
gen()
\`\`\`
Gera senha segura + hash SHA256

**4. Alternar Tema**
\`\`\`
toggle()
\`\`\`
Muda entre temas: üî¥ Vermelho, üü¢ Verde, üü† Laranja

**5. Exportar Logs**
\`\`\`
exportLogs()
\`\`\`
Exporta hist√≥rico em formato CSV

**Como executar:**
- Use os **bot√µes** na interface
- Abra os **modais** correspondentes
- Ou pe√ßa para eu executar algum comando!

üí° **Todos os comandos s√£o executados no terminal do sistema.**`;
    
    } else if (lowerMessage.includes('nemo system') || lowerMessage.includes('sistema') || lowerMessage.includes('o que √©')) {
      return `**üöÄ Nemo System - Plataforma de Administra√ß√£o Completa**

**O que √© o Nemo System?**
Uma plataforma web completa para administra√ß√£o e monitoramento, desenvolvida com tecnologias modernas.

**Tecnologias utilizadas:**
- **Frontend:** HTML5, CSS3, JavaScript (ES6+)
- **Armazenamento:** localStorage do navegador
- **Autentica√ß√£o:** Hash SHA256 para seguran√ßa
- **IA Integrada:** Google Gemini API
- **Design:** Interface responsiva e moderna

**Funcionalidades principais:**
üîê **Autentica√ß√£o segura** com sistema de roles
üìä **Painel administrativo** com gr√°ficos em tempo real
üîç **Ferramentas de rede** (scanner, ping, monitoramento)
üõ† **Utilit√°rios** (gerador de senhas, temas personalizados)
üëë **Sistema de modera√ß√£o** (gerenciamento de usu√°rios)
üì± **Interface responsiva** (desktop, tablet, mobile)
ü§ñ **Assistente IA integrado** (este assistente!)

**Para quem √© indicado:**
- Administradores de sistema
- Desenvolvedores que precisam de ferramentas r√°pidas
- Estudantes de tecnologia
- Qualquer pessoa interessada em ferramentas de administra√ß√£o

**üåü Caracter√≠sticas √∫nicas:**
- **Zero instala√ß√£o** - Funciona direto no navegador
- **Privacidade** - Dados ficam no seu dispositivo
- **Gratuito** - Sem custos ou assinaturas
- **Open Source** - C√≥digo dispon√≠vel para estudo

**Pronto para explorar?** Comece fazendo login e descubra todas as funcionalidades! üéâ`;
    
    } else if (lowerMessage.includes('ola') || lowerMessage.includes('oi') || lowerMessage.includes('bom dia') || lowerMessage.includes('boa tarde') || lowerMessage.includes('boa noite')) {
      const greetings = [
        "Ol√°! Como posso ajudar voc√™ hoje no Nemo System? üòä",
        "Oi! Em que posso ser √∫til? Estou aqui para ajudar! ü§ñ",
        "Ol√°! Pronto para explorar o Nemo System com voc√™! üöÄ",
        "Oi! Que bom ver voc√™ aqui! Como posso ajudar? üåü"
      ];
      return greetings[Math.floor(Math.random() * greetings.length)];
    
    } else {
      return AI_CONFIG.FALLBACK_RESPONSES[
        Math.floor(Math.random() * AI_CONFIG.FALLBACK_RESPONSES.length)
      ];
    }
  }
}

/* ======= GERENCIAMENTO DE MENU MOBILE ======= */
function setupMobileMenu() {
  const menuToggle = document.getElementById('menuToggle');
  const sidebar = document.getElementById('sidebar');
  const overlay = document.getElementById('overlay');
  
  if (menuToggle && sidebar) {
    menuToggle.addEventListener('click', () => {
      sidebar.classList.toggle('active');
      overlay.classList.toggle('active');
      document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
    });
    
    overlay.addEventListener('click', () => {
      sidebar.classList.remove('active');
      overlay.classList.remove('active');
      document.body.style.overflow = '';
    });
    
    sidebar.querySelectorAll('button').forEach(button => {
      button.addEventListener('click', () => {
        if (window.innerWidth <= 768) {
          sidebar.classList.remove('active');
          overlay.classList.remove('active');
          document.body.style.overflow = '';
        }
      });
    });
    
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
        document.body.style.overflow = '';
      }
    });
  }
}

/* ======= CRIPTO ======= */
async function hash(t){const e=new TextEncoder().encode(t),b=await crypto.subtle.digest("SHA-256",e);return[...new Uint8Array(b)].map(x=>x.toString(16).padStart(2,"0")).join("")}

/* ======= INICIALIZA√á√ÉO DO SISTEMA ======= */
let deviceDetector;
let nemoAI;

async function initializeSystem() {
  // Inicializa detector de dispositivo
  deviceDetector = new DeviceDetector();
  
  // Inicializa IA (ser√° iniciada quando abrir a p√°gina da IA)
  
  // Configura menu mobile
  setupMobileMenu();
  
  // Verifica se o usu√°rio Nemo j√° existe no sistema
  const nemoExists = localStorage.getItem("user_Nemo");
  
  if (!nemoExists) {
    await createDefaultAdmin();
  } else {
    await updateAdminPassword();
  }
}

/* ======= CRIA√á√ÉO DO ADMIN PADR√ÉO ======= */
async function createDefaultAdmin() {
  const customPassword = "gustavo270908";
  const passHash = await hash(customPassword);
  
  localStorage.setItem("user_Nemo", passHash);
  localStorage.setItem("role_Nemo", "admin");
  
  const ua = navigator.userAgent;
  const createdAt = new Date().toISOString();
  let ip = "127.0.0.1";
  
  try {
    const res = await fetch('https://api.ipify.org?format=json');
    if(res.ok) {
      const data = await res.json();
      ip = data.ip;
    }
  } catch(e) {
    // Usa IP padr√£o se n√£o conseguir obter
  }
  
  const meta = {
    role: "admin",
    createdAt,
    createdIP: ip,
    createdUA: ua,
    banned: false,
    logins: []
  };
  
  localStorage.setItem("meta_Nemo", JSON.stringify(meta));
  console.log("Usu√°rio admin 'Nemo' criado automaticamente. Senha: gustavo270908");
}

/* ======= ATUALIZA√á√ÉO DE SENHA DO ADMIN ======= */
async function updateAdminPassword() {
  const newPassword = "gustavo270908";
  const newPassHash = await hash(newPassword);
  
  localStorage.setItem("user_Nemo", newPassHash);
  localStorage.setItem("role_Nemo", "admin");
  
  const metaKey = "meta_Nemo";
  let meta = JSON.parse(localStorage.getItem(metaKey) || '{}');
  meta.role = "admin";
  meta.banned = false;
  localStorage.setItem(metaKey, JSON.stringify(meta));
  
  console.log("Senha do admin 'Nemo' atualizada para: gustavo270908");
}

/* ======= FUN√á√ïES DA INTERFACE ======= */
function hideAllPages() {
  document.getElementById('loginBox').classList.add('hidden');
  document.getElementById('registerBox').classList.add('hidden');
  document.getElementById('painelBox').classList.add('hidden');
  document.getElementById('aiPage').classList.add('hidden');
}

function showLogin() {
  hideAllPages();
  document.getElementById('loginBox').classList.remove('hidden');
  lUser.value = "";
  lPass.value = "";
}

function showRegister() {
  hideAllPages();
  document.getElementById('registerBox').classList.remove('hidden');
  rUser.value = "";
  rPass.value = "";
}

function openPainel() {
  const u = localStorage.getItem("session"); 
  if(!u) return alert("Fa√ßa login primeiro");
  
  hideAllPages(); 
  document.getElementById('painelBox').classList.remove('hidden');
  userName.textContent = u;
  
  const role = localStorage.getItem("role_"+u) || "user";
  userRole.textContent = role;
  
  document.querySelector(".admin").style.display = (u === "Nemo") ? "block" : "none";
  
  document.getElementById('loginBtn').style.display = 'none';
  document.getElementById('registerBtn').style.display = 'none';
  document.getElementById('painelBtn').style.display = 'block';
  document.getElementById('aiBtn').style.display = 'block';
  document.getElementById('logoutBtn').style.display = 'block';
  
  const terminal = document.getElementById('terminal');
  if (terminal) terminal.innerHTML = ""; 
  
  log("Sistema Nemo iniciado");
  log(`Bem-vindo, ${u}`);
  
  if (deviceDetector) {
    const deviceInfo = deviceDetector.getDeviceInfo();
    log(`Dispositivo: ${deviceInfo.type} | OS: ${deviceInfo.os}`);
    log(`Navegador: ${deviceInfo.browser} | Conex√£o: ${deviceInfo.connection}`);
  }
  
  startChart();
}

function openAIPage() {
  const u = localStorage.getItem("session"); 
  if(!u) return alert("Fa√ßa login primeiro");
  
  hideAllPages();
  document.getElementById('aiPage').classList.remove('hidden');
  
  // Inicializar IA se ainda n√£o foi iniciada
  if (!nemoAI) {
    nemoAI = new NemoAIAssistant();
  }
  
  // Atualizar bot√µes da sidebar
  document.getElementById('loginBtn').style.display = 'none';
  document.getElementById('registerBtn').style.display = 'none';
  document.getElementById('painelBtn').style.display = 'block';
  document.getElementById('aiBtn').style.display = 'block';
  document.getElementById('logoutBtn').style.display = 'block';
  
  // Focar no input do chat
  setTimeout(() => {
    const chatInput = document.getElementById('chatInput');
    if (chatInput) chatInput.focus();
  }, 300);
}

/* ======= FUN√á√ïES DA IA (para acesso global) ======= */
function sendAIMessage() {
  if (nemoAI) {
    nemoAI.sendMessage();
  }
}

function sendQuickAIMessage(text) {
  if (nemoAI) {
    nemoAI.sendQuickMessage(text);
  }
}

/* ======= RESTANTE DO C√ìDIGO (mantendo as fun√ß√µes existentes) ======= */
let logs=[];
function log(m){
  logs.push(m);
  const terminal = document.getElementById('terminal');
  if (terminal) {
    terminal.innerHTML += `<span>> ${m}</span><br>`;
    terminal.scrollTop = terminal.scrollHeight;
  }
}

async function register(){
  if(!rUser.value||!rPass.value) return alert("Campos vazios");
  const username = rUser.value.trim();
  
  if(localStorage.getItem("user_"+username)) return alert("Usu√°rio j√° existe");
  
  const passHash = await hash(rPass.value);
  localStorage.setItem("user_"+username, passHash);
  
  const role = "user";
  localStorage.setItem("role_"+username, role);
  
  const ua = navigator.userAgent;
  const createdAt = new Date().toISOString();
  const ip = await getIP().catch(()=>"127.0.0.1");
  const meta = {
    role, 
    createdAt, 
    createdIP: ip, 
    createdUA: ua, 
    banned: false, 
    logins: [],
    deviceInfo: deviceDetector ? deviceDetector.getDeviceInfo() : null
  };
  localStorage.setItem("meta_"+username, JSON.stringify(meta));
  
  alert("Conta criada com sucesso!"); 
  showLogin();
}

async function login(){
  const username = lUser.value.trim();
  const password = lPass.value;
  
  if(!username || !password) return alert("Preencha todos os campos");
  
  const storedHash = localStorage.getItem("user_"+username);
  if(!storedHash) return alert("Usu√°rio n√£o encontrado");
  
  const inputHash = await hash(password);
  
  if(storedHash === inputHash){
    const metaKey = "meta_"+username;
    const meta = JSON.parse(localStorage.getItem(metaKey) || '{}');
    if(meta.banned) return alert('Conta banida');
    
    const ip = await getIP().catch(()=>"127.0.0.1");
    const entry = {
      at: new Date().toISOString(), 
      ip: ip, 
      ua: navigator.userAgent,
      deviceInfo: deviceDetector ? deviceDetector.getDeviceInfo() : null
    };
    meta.logins = meta.logins || [];
    meta.logins.push(entry);
    localStorage.setItem(metaKey, JSON.stringify(meta));
    
    localStorage.setItem("session", username);
    openPainel();
  } else {
    alert("Senha incorreta");
  }
}

function logout(){
  localStorage.removeItem("session");
  document.getElementById('loginBtn').style.display = 'block';
  document.getElementById('registerBtn').style.display = 'block';
  document.getElementById('painelBtn').style.display = 'none';
  document.getElementById('aiBtn').style.display = 'none';
  document.getElementById('logoutBtn').style.display = 'none';
  showLogin();
}

/* ======= MODAIS ======= */
function openModal(t){
  modal.style.display = "flex";
  modalTitle.textContent = t.toUpperCase();
  
  if(t === "scanner") modalBody.innerHTML = `<button onclick="scan()" class="pulse">Iniciar Scan</button>`;
  if(t === "network") modalBody.innerHTML = `<button onclick="ping()">Testar Ping</button>`;
  if(t === "tools") modalBody.innerHTML = `<button onclick="gen()">Gerar Senha Segura</button>`;
  if(t === "config") modalBody.innerHTML = `<button onclick="toggle()">Alternar Tema</button>`;
  
  if(t === "admin"){
    const current = localStorage.getItem('session');
    if(current !== 'Nemo'){
      modalBody.innerHTML = `<p style="color:var(--primary-light); padding: 20px; text-align: center;">Acesso restrito ao administrador</p>`;
      return;
    }
    modalBody.innerHTML = `<div id="adminContainer"></div>`;
    renderAdmin();
  }
}

function closeModal(){
  modal.style.display = "none";
  modalBody.innerHTML = "";
}

/* ======= A√á√ïES ======= */
function scan(){
  log("Iniciando scan de portas...");
  [21,22,80,443].forEach((p,i)=>setTimeout(()=>{
    const status = Math.random()>.5?"ABERTA":"FECHADA";
    log(`Porta ${p}: ${status}`);
  },i*300))
}

function ping(){
  log("Enviando ping...");
  setTimeout(()=>{
    const latency = (20+Math.random()*80).toFixed(0);
    log(`Ping: ${latency}ms`);
  },500)
}

async function gen(){
  const p = Math.random().toString(36).slice(-10);
  log("Gerando senha segura...");
  setTimeout(async ()=>{
    log(`Senha: ${p}`);
    log(`SHA256: ${await hash(p)}`);
  },300)
}

function toggle(){
  const root = document.documentElement;
  const currentPrimary = getComputedStyle(root).getPropertyValue("--primary").trim();
  
  if(currentPrimary === "#b00000"){
    root.style.setProperty("--primary", "#00cc88");
    root.style.setProperty("--primary-light", "#33ffaa");
    log("Tema alterado: Modo Verde");
  } else if(currentPrimary === "#00cc88"){
    root.style.setProperty("--primary", "#ffaa00");
    root.style.setProperty("--primary-light", "#ffcc44");
    log("Tema alterado: Modo Laranja");
  } else {
    root.style.setProperty("--primary", "#b00000");
    root.style.setProperty("--primary-light", "#ff3333");
    log("Tema alterado: Modo Vermelho (Padr√£o)");
  }
}

async function getIP(){
  try{
    const res = await fetch('https://api.ipify.org?format=json');
    if(!res.ok) throw new Error('Erro na requisi√ß√£o');
    const j = await res.json();
    return j.ip;
  }catch(e){
    return "127.0.0.1";
  }
}

/* ======= CHART ======= */
let ctx = document.getElementById("chart").getContext("2d");
let data = [];

function startChart(){
  data = []; 
  setInterval(()=>{
    data.push(Math.random()*100); 
    if(data.length > 20) data.shift();
    
    const chartCanvas = document.getElementById("chart");
    if (!chartCanvas) return;
    
    ctx.clearRect(0,0,chartCanvas.width,chartCanvas.height);
    
    const gradient = ctx.createLinearGradient(0, 0, chartCanvas.width, 0);
    gradient.addColorStop(0, getComputedStyle(document.documentElement).getPropertyValue("--primary"));
    gradient.addColorStop(1, getComputedStyle(document.documentElement).getPropertyValue("--primary-light"));
    
    ctx.strokeStyle = gradient;
    ctx.lineWidth = 2;
    ctx.beginPath();
    data.forEach((v,i)=>ctx.lineTo(i*(chartCanvas.width/20),chartCanvas.height-v));
    ctx.stroke();
    
    ctx.fillStyle = gradient;
    data.forEach((v,i)=>{
      ctx.beginPath();
      ctx.arc(i*(chartCanvas.width/20),chartCanvas.height-v,3,0,Math.PI*2);
      ctx.fill();
    });
  },1000);
}

/* ======= INICIALIZA√á√ÉO DA P√ÅGINA ======= */
window.onload = async function() {
  await initializeSystem();
  
  if(localStorage.getItem("session")) {
    openPainel();
  } else {
    document.getElementById('loginBtn').style.display = 'block';
    document.getElementById('registerBtn').style.display = 'block';
    document.getElementById('painelBtn').style.display = 'none';
    document.getElementById('aiBtn').style.display = 'none';
    document.getElementById('logoutBtn').style.display = 'none';
    showLogin();
  }
};

window.addEventListener('resize', () => {
  if (deviceDetector) {
    deviceDetector.detectScreen();
  }
  
  if (window.innerWidth > 768) {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('overlay');
    if (sidebar && overlay) {
      sidebar.classList.remove('active');
      overlay.classList.remove('active');
      document.body.style.overflow = '';
    }
  }
});
</script>
</body>
</html>
